#!/Users/jlibbey/.dotfiles/env/bin/python

import os
import sys

from phabricator import Phabricator

DESCRIPTION = '<<cli generated>>'


def main():
    if len(sys.argv) > 1:
        phab = Phabricator()  # This will use your ~/.arcrc file
        task = phab.maniphest.createtask(
            title=' '.join(sys.argv[1:]),
            description=DESCRIPTION,
            projectPHIDs=[os.environ.get("PHID_XCHANGE")],
            ccPHIDs=[
                os.environ.get("PHID_XCHANGE"),
                os.environ.get("PHID_ME"),
            ],
            auxiliary={
                'std:maniphest:task_type': 'task',
                'uber:maniphest_category': 'xchange',
                'std:maniphest:uber:catephory': '["PHID-UCAT-hbfujyrb2kod5s3u7zws"]',
            },
            ownerPHID=os.environ.get("PHID_ME"),
        )
        print(task.uri)
    else:
        print('Usage: {0} <arg>'.format(os.path.basename(sys.argv[0])))


if __name__ == '__main__':
    main()
